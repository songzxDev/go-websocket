fork from golang.org/x/net/websocket
change stream handlering
when each message, return io.EOF